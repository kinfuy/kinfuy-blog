import{_ as n,c as a,o as s,b as t}from"./app.f3271562.js";var p="/articles/1.webp";const m='{"title":"\u4F60\u8FD8\u4E0D\u77E5\u9053\u600E\u4E48\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\uFF1F","description":"","frontmatter":{"title":"\u4F60\u8FD8\u4E0D\u77E5\u9053\u600E\u4E48\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\uFF1F","theme":"default","tag":"Javascript","time":"2021.6.11"},"headers":[{"level":3,"title":"\u4EC0\u4E48\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F","slug":"\u4EC0\u4E48\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F"},{"level":3,"title":"\u5982\u4F55\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\uFF1F","slug":"\u5982\u4F55\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\uFF1F"},{"level":3,"title":"\u4EC0\u4E48\u6837\u7684\u8BF7\u6C42\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F","slug":"\u4EC0\u4E48\u6837\u7684\u8BF7\u6C42\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F"},{"level":3,"title":"\u90E8\u5206\u4EE3\u7801","slug":"\u90E8\u5206\u4EE3\u7801"}],"relativePath":"views/article/Javascript/libs/axios.md"}',o={},e=t('<p><img src="'+p+`" alt=""></p><h3 id="\u4EC0\u4E48\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F" tabindex="-1">\u4EC0\u4E48\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F <a class="header-anchor" href="#\u4EC0\u4E48\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F" aria-hidden="true">#</a></h3><p>\u5728 web \u5F00\u53D1\u8FC7\u7A0B\u4E2D\uFF0C\u6211\u4EEC\u7ECF\u5E38\u9047\u89C1\u9700\u8981\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\u7684\u9700\u6C42\uFF0C\u7F51\u7EDC\u4E0D\u597D\u65F6\uFF0C\u7528\u6237\u53EF\u80FD\u91CD\u590D\u70B9\u51FB\u67D0\u4E2A\u6309\u94AE\u5C31\u89E6\u53D1\u4E86\u591A\u6B21\u76F8\u540C\u8BF7\u6C42\u3002\u53EF\u80FD\u4F1A\u9020\u6210\u6570\u636E\u9519\u4E71\u7684\u95EE\u9898\u3002</p><h3 id="\u5982\u4F55\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\uFF1F" tabindex="-1">\u5982\u4F55\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\uFF1F <a class="header-anchor" href="#\u5982\u4F55\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42\uFF1F" aria-hidden="true">#</a></h3><ul><li>axios \u4E2D\u63D0\u4F9B\u4E86 cancelToken \u7684\u5C5E\u6027\u6765\u53D6\u6D88\u8BF7\u6C42\u3002</li><li>\u539F\u7406\u5C31\u662F\u5229\u7528\u4E86 XMLHttpRequest \u5BF9\u8C61\u4E0A\u7684 abort \u65B9\u6CD5\u6765\u53D6\u6D88\u8BF7\u6C42</li></ul><h3 id="\u4EC0\u4E48\u6837\u7684\u8BF7\u6C42\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F" tabindex="-1">\u4EC0\u4E48\u6837\u7684\u8BF7\u6C42\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F <a class="header-anchor" href="#\u4EC0\u4E48\u6837\u7684\u8BF7\u6C42\u662F\u91CD\u590D\u8BF7\u6C42\uFF1F" aria-hidden="true">#</a></h3><ul><li>\u8BF7\u6C42\u65B9\u5F0F</li><li>\u8BF7\u6C42\u5730\u5740</li><li>\u8BF7\u6C42\u53C2\u6570 \u4EE5\u4E0A\u4E09\u8005\u5B8C\u5168\u4E00\u81F4\u5373\u8BA4\u4E3A\u8BE5\u8BF7\u6C42\u5B8C\u5168\u76F8\u540C</li></ul><h3 id="\u90E8\u5206\u4EE3\u7801" tabindex="-1">\u90E8\u5206\u4EE3\u7801 <a class="header-anchor" href="#\u90E8\u5206\u4EE3\u7801" aria-hidden="true">#</a></h3><p>\u6CE8\u610F\uFF1A\u8FD9\u91CC\u5E8F\u5217\u5316\u53C2\u6570\u8FD9\u91CC\u7528\u4E86 JSON.stringify\uFF0C\u4EC5\u505A\u6F14\u793A\uFF0CJSON.stringify \u5B58\u5728\u7684\u7F3A\u9677\u5C31\u4E0D\u5728\u8FD9\u91CC\u8D58\u8FF0\u4E86\uFF0C\u6CE8\u610F\u4F7F\u7528\u3002</p><div class="language-js"><pre><code><span class="token keyword">const</span> instance <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">timeout</span><span class="token operator">:</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">6</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> pending <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cancelToken <span class="token operator">=</span> axios<span class="token punctuation">.</span>CancelToken<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">removePending</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  pending<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> requestFunc <span class="token operator">=</span> config<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&#39;/&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u6587\u4EF6\u5206\u7247\u4E0D\u7528\u62E6\u622A</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>requestFunc <span class="token operator">!==</span> <span class="token string">&#39;filesectioning&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>
        item<span class="token punctuation">.</span>requestFlag <span class="token operator">===</span>
        <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>config<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>config<span class="token punctuation">.</span>method<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>
          config<span class="token punctuation">.</span>params
        <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span>
      <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        item<span class="token punctuation">.</span><span class="token function">cancel</span><span class="token punctuation">(</span><span class="token string">&#39;\u53D6\u6D88\u91CD\u590D\u8BF7\u6C42&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pending<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
instance<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">removePending</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    request<span class="token punctuation">.</span>cancelToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">cancelToken</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">cancel</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> requestFlag <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>request<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>request<span class="token punctuation">.</span>method<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>
        request<span class="token punctuation">.</span>params
      <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">;</span>
      pending<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> requestFlag<span class="token punctuation">,</span> cancel <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> request<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>`,10),c=[e];function u(i,l,k,r,d,g){return s(),a("div",null,c)}var h=n(o,[["render",u]]);export{m as __pageData,h as default};
